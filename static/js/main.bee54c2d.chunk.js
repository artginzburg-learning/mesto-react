(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e){e.exports=JSON.parse('{"a":"Art Ginzburg"}')},19:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(10),o=n.n(r),s=(n(19),n(4)),i=n.n(s),u=n(2),l=n(8),d=n(7),b=n(3);function j(e,t){var n=Object(a.useState)(localStorage[e]?JSON.parse(localStorage[e]):t),c=Object(b.a)(n,2),r=c[0],o=c[1],s=Object(a.useCallback)((function(n){n.key===e&&o(n.newValue?JSON.parse(n.newValue):t)}),[e,t]),i=Object(a.useCallback)((function(t){localStorage[e]=JSON.stringify(t),o(t)}),[e]);return Object(a.useEffect)((function(){var e,t=["storage",s];return(e=window).addEventListener.apply(e,t),function(){var e;(e=window).removeEventListener.apply(e,t)}}),[s]),[r,i]}var m=n(11),p=n(12),f="mesto.nomoreparties.co",O="https://",h="v1",_=new(function(){function e(t){var n=this;Object(m.a)(this,e),this._paths={users:"users/me",cards:"cards"},this._handleFetch=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},this.editProfile=function(e){var t=e.name,a=e.about;return n._customFetch(n._paths.users,"PATCH",{name:t,about:a})},this.addCard=function(e,t){return n._customFetch(n._paths.cards,"POST",{name:e,link:t})},this.deleteCard=function(e){return n._customFetch("".concat(n._paths.cards,"/").concat(e),"DELETE")},this.changeLikeCardStatus=function(e,t){return n._customFetch("".concat(n._paths.cards,"/likes/").concat(e),t?"PUT":"DELETE")},this.updateAvatar=function(e){var t=e.avatar;return n._customFetch("".concat(n._paths.users,"/avatar"),"PATCH",{avatar:t})},this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(p.a)(e,[{key:"_customFetch",value:function(e,t,n){var a={headers:this._headers};return t&&"GET"!==t&&(a.method=t,"DELETE"!==t&&(a.headers["Content-Type"]="application/json")),n&&(a.body=JSON.stringify(n)),fetch("".concat(this._baseUrl,"/").concat(e),a).then(this._handleFetch)}},{key:"getUserInfo",value:function(){return this._customFetch(this._paths.users)}},{key:"getInitialCards",value:function(){return this._customFetch(this._paths.cards)}}]),e}())({baseUrl:"".concat(O).concat(f,"/").concat(h,"/").concat("cohort-24"),headers:{authorization:"70313b07-c3c0-40aa-a296-04d0e6bc7885"}}),v={name:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439",about:"\u041f\u043e\u0442\u0435\u0440\u044f\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c",avatar:""},x=c.a.createContext(),C=c.a.createContext();function g(){var e=c.a.useContext(C);if(void 0===e)throw new Error("useCurrentUserDispatcher must be used within a CurrentUserProvider");return e}function k(e,t){return JSON.stringify(e)===JSON.stringify(t)}function N(e,t,n,a){return y.apply(this,arguments)}function y(){return(y=Object(d.a)(i.a.mark((function e(t,n,a,c){var r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(u.a)(Object(u.a)({},n),a),t(r),e.prev=2,e.next=5,_[c](a);case 5:o=e.sent,k(r,o)||t(o),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(2),t(n),e.t0;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}for(var S=n.p+"static/media/logo.6fa47d29.svg",E=n(0),w=Object(a.memo)((function(){return Object(E.jsx)("header",{className:"header",children:Object(E.jsx)("a",{target:"_self",href:"https://github.com/artginzburg/mesto-react",className:"logo header__logo",children:Object(E.jsx)("img",{className:"logo__img",alt:"Mesto",src:S})})})})),L=Object(a.memo)((function(e){var t,n=e.card;n.likes=null!==(t=n.likes)&&void 0!==t?t:[];var c=Object(a.useContext)(x);n.isTemporarilyLocal&&(n.owner=c);var r="element__trash-button"+(n.owner._id===c._id?" element__trash-button_visible":""),o="element__like-button"+(n.likes.some((function(e){return e._id===c._id}))?" element__like-button_active":"");return Object(E.jsxs)("li",{className:"element",children:[Object(E.jsx)("img",{onClick:function(){e.onCardClick(n)},className:"element__image",alt:n.name,src:n.link}),Object(E.jsx)("button",{onClick:function(){n.isTemporarilyLocal||e.onCardDelete(n)},type:"reset",className:r}),Object(E.jsxs)("div",{className:"element__container",children:[Object(E.jsx)("h2",{className:"element__title",children:n.name}),Object(E.jsxs)("div",{className:"element__likes",children:[Object(E.jsx)("button",{onClick:function(){n.isTemporarilyLocal||e.onCardLike(n)},type:"button",className:o}),Object(E.jsx)("p",{className:"element__like-counter",children:n.likes.length})]})]})]})})),T={isTemporarilyLocal:!0,name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."},F=[],P=0;P<30;P++)F.push(T);var U=Object(a.memo)((function(e){var t=Object(a.useContext)(x),n=Object(a.useMemo)((function(){return e.cards.length?e.cards:F}),[e.cards]);return Object(E.jsxs)("main",{className:"content",children:[Object(E.jsxs)("section",{className:"profile",children:[Object(E.jsx)("button",{onClick:e.onEditAvatar,type:"button",className:"profile__avatar-container",children:Object(E.jsx)("img",{alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar",src:t.avatar})}),Object(E.jsxs)("div",{className:"profile__info",children:[Object(E.jsx)("h1",{className:"profile__name",children:t.name}),Object(E.jsx)("p",{className:"profile__description",children:t.about}),Object(E.jsx)("button",{onClick:e.onEditProfile,type:"button",className:"profile__edit-button"})]}),Object(E.jsx)("button",{onClick:e.onAddPlace,type:"button",className:"profile__add-button"})]}),Object(E.jsx)("section",{className:"elements",children:Object(E.jsx)("ul",{className:"elements__list",children:n.map((function(t){var n;return Object(E.jsx)(L,{onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete,card:t},null!==(n=t._id)&&void 0!==n?n:Math.random())}))})})]})})),A=n(13),D=Object(a.memo)((function(){return Object(E.jsx)("footer",{className:"footer",children:Object(E.jsxs)("a",{target:"_blank",rel:"noreferrer",href:"https://github.com/artginzburg",className:"footer__copyright",children:["\xa9 2021 ",A.a]})})})),J="popup__close-button",I="popup",R=" ".concat(I,"_opened"),z=!1,M=Object(a.memo)((function(e){var t=Object(a.useState)(""),n=Object(b.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(z),s=Object(b.a)(o,2),i=s[0],u=s[1];if(Object(a.useEffect)((function(){if(e.isOpen||document.activeElement.blur(),e.isOpen){u(!0);var t=setTimeout((function(){r(R)}),10);return function(){return clearTimeout(t)}}r("");var n=setTimeout((function(){u(z)}),300);return function(){return clearTimeout(n)}}),[e.isOpen]),!i)return null;var l=e.className?" ".concat(e.className," "):"",d=I+l+c;return Object(E.jsx)("section",{onClick:e.onClick,className:d,id:e.id,children:e.children})})),q=Object(a.memo)((function(e){var t,n=e.onSubmit,c=e.children,r=Object(a.useCallback)((function(e){n&&(e.preventDefault(),n(e)),c&&e.target.reset()}),[c,n]),o=null!==(t=e.buttonTitle)&&void 0!==t?t:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c";return Object(E.jsx)(M,{isOpen:e.isOpen,onClick:e.onClose,id:e.name,children:Object(E.jsxs)("div",{className:"popup__container",children:[Object(E.jsx)("button",{type:"reset",className:J}),Object(E.jsx)("h2",{className:"popup__title",children:e.title}),Object(E.jsxs)("form",{onSubmit:r,onReset:e.onReset,className:"popup__form",action:"#",children:[c,Object(E.jsx)("button",{type:"submit",className:"popup__button",children:o})]})]})})})),B=n(14),G=["isFocused"],H="text",V=!0,K=2,Q=Object(a.forwardRef)((function(e,t){var n,c,r,o=null!==t&&void 0!==t?t:Object(a.createRef)(),s=null!==(n=e.type)&&void 0!==n?n:H,i=null!==(c=e.required)&&void 0!==c?c:V,l=s===H?K:null,d={type:s,minLength:null!==(r=e.minLength)&&void 0!==r?r:l,required:i,ref:o},b=e.isFocused,j=Object(B.a)(e,G);return Object(a.useEffect)((function(){b&&o&&o.current&&o.current.parentElement!==document.activeElement.parentElement&&setTimeout((function(){o&&o.current&&o.current.focus()}),50)}),[b,o]),Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("input",Object(u.a)(Object(u.a)({},j),{},{className:"popup__input"},d)),Object(E.jsx)("p",{className:"popup__error",id:"".concat(e.id,"-error")})]})})),W=Object(a.memo)((function(e){var t=Object(a.useState)(""),n=Object(b.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(""),s=Object(b.a)(o,2),i=s[0],l=s[1],d=Object(a.useContext)(x),j=g();return Object(a.useEffect)((function(){r(d.name),l(d.about)}),[d]),Object(E.jsxs)(q,Object(u.a)(Object(u.a)({},e),{},{onSubmit:function(){N(j,d,{name:c,about:i},"editProfile"),e.onUpdateUser()},title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile-editor",children:[Object(E.jsx)(Q,{isFocused:e.isOpen,value:c,onChange:function(e){r(e.target.value)},autoComplete:"name",autoCapitalize:"words",name:"name",id:"profile-name",placeholder:"\u0418\u043c\u044f",maxLength:"40"}),Object(E.jsx)(Q,{value:i,onChange:function(e){l(e.target.value)},name:"about",id:"profile-about",placeholder:"\u041e \u0441\u0435\u0431\u0435",maxLength:"200"})]}))})),X=Object(a.memo)((function(e){var t=Object(a.useRef)(),n=Object(a.useContext)(x),c=g();return Object(E.jsx)(q,Object(u.a)(Object(u.a)({},e),{},{onSubmit:function(){N(c,n,{avatar:t.current.value},"updateAvatar"),e.onUpdateAvatar()},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar-editor",children:Object(E.jsx)(Q,{isFocused:e.isOpen,ref:t,type:"url",name:"avatar",id:"profile-avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"})}))})),Y="",Z="",$=Object(a.memo)((function(e){var t=Object(a.useState)(Y),n=Object(b.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(Z),s=Object(b.a)(o,2),i=s[0],l=s[1];return Object(E.jsxs)(q,Object(u.a)(Object(u.a)({},e),{},{onSubmit:function(){e.onAddPlace(c,i)},onReset:function(){r(Y),l(Z)},title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"element-editor",buttonTitle:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:[Object(E.jsx)(Q,{isFocused:e.isOpen,value:c,onChange:function(e){r(e.target.value)},name:"title",id:"element-title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",maxLength:"30"}),Object(E.jsx)(Q,{value:i,onChange:function(e){l(e.target.value)},type:"url",name:"link",id:"element-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"})]}))})),ee=Object(a.memo)((function(e){return Object(E.jsx)(q,Object(u.a)(Object(u.a)({},e),{},{onSubmit:function(){e.onCardDelete(e.card)},title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete-confirmation",buttonTitle:"\u0414\u0430"}))})),te=Object(a.memo)((function(e){var t=e.card;return Object(E.jsx)(M,{isOpen:e.isOpen,onClick:e.onClose,className:"popup_type_image",id:"image-viewer",children:Object(E.jsxs)("figure",{className:"popup__figure",children:[Object(E.jsx)("button",{type:"button",className:"".concat(J," ").concat(J,"_parent-corners_straight")}),Object(E.jsx)("img",{className:"popup__image",alt:t.name,src:t.link}),Object(E.jsx)("figcaption",{className:"popup__caption",children:t.name})]})})}));function ne(){var e=j("currentUser",v),t=Object(b.a)(e,2),n=t[0],a=t[1];c.a.useEffect((function(){_.getUserInfo().then(a)}),[a]);var r=c.a.useState(!1),o=Object(b.a)(r,2),s=o[0],m=o[1],p=c.a.useState(!1),f=Object(b.a)(p,2),O=f[0],h=f[1],g=c.a.useState(!1),k=Object(b.a)(g,2),N=k[0],y=k[1],S=c.a.useState(!1),L=Object(b.a)(S,2),T=L[0],F=L[1],P=c.a.useState(!1),A=Object(b.a)(P,2),J=A[0],I=A[1],R=c.a.useState({}),z=Object(b.a)(R,2),M=z[0],q=z[1],B=j("cards",[]),G=Object(b.a)(B,2),H=G[0],V=G[1];function K(){return(K=Object(d.a)(i.a.mark((function e(t){var a,c,r,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=H,c=t.likes.some((function(e){return e._id===n._id})),r=c?t.likes.filter((function(e){return e._id!==n._id})):[].concat(Object(l.a)(t.likes),[n]),o=Object(u.a)(Object(u.a)({},t),{},{likes:r}),V(H.map((function(e){return e._id===t._id?o:e}))),e.prev=5,e.next=8,_.changeLikeCardStatus(t._id,!c);case 8:s=e.sent,V(H.map((function(e){return e._id===t._id?s:e}))),e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(5),V(a),e.t0;case 16:case"end":return e.stop()}}),e,null,[[5,12]])})))).apply(this,arguments)}function Q(){y(!1),m(!1),h(!1),F(!1),I(!1)}c.a.useEffect((function(){_.getInitialCards().then(V)}),[V]);var Y=c.a.useCallback((function(e){var t=H;V(H.filter((function(t){return t._id!==e._id}))),_.deleteCard(e._id).catch((function(e){throw V(t),e})),Q()}),[H,V]);var Z=c.a.useCallback((function(e){e.target===e.currentTarget&&Q()}),[]),ne=Q,ae=Q;var ce=c.a.useCallback((function(e){"Escape"===e.key&&Q()}),[]);return c.a.useEffect((function(){var e,t=["keydown",ce,!1];return(e=document).addEventListener.apply(e,t),function(){var e;return(e=document).removeEventListener.apply(e,t)}}),[ce]),Object(E.jsx)(x.Provider,{value:n,children:Object(E.jsxs)(C.Provider,{value:a,children:[Object(E.jsx)(w,{}),Object(E.jsx)(U,{onEditProfile:function(){m(!0)},onAddPlace:function(){h(!0)},onEditAvatar:function(){y(!0)},cards:H,onCardClick:function(e){q(e),I(!0)},onCardLike:function(e){return K.apply(this,arguments)},onCardDelete:function(e){q(e),F(!0)}}),Object(E.jsx)(D,{}),Object(E.jsx)(W,{onUpdateUser:ne,isOpen:s,onClose:Z}),Object(E.jsx)($,{onAddPlace:function(e,t){var n=H;V([{isTemporarilyLocal:!0,name:e,link:t}].concat(Object(l.a)(H))),_.addCard(e,t).then((function(e){return V([e].concat(Object(l.a)(H)))})).catch((function(){return V(n)})),Q()},isOpen:O,onClose:Z}),Object(E.jsx)(X,{onUpdateAvatar:ae,isOpen:N,onClose:Z}),Object(E.jsx)(ee,{card:M,onCardDelete:Y,isOpen:T,onClose:Z}),Object(E.jsx)(te,{card:M,isOpen:J,onClose:Z})]})})}var ae=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(E.jsx)(c.a.StrictMode,{children:Object(E.jsx)(ne,{})}),document.getElementById("root")),ae()}},[[22,1,2]]]);
//# sourceMappingURL=main.bee54c2d.chunk.js.map